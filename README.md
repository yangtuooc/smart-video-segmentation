# Smart Video Segmentation

æ™ºèƒ½è§†é¢‘åˆ†å‰²å·¥å…· - åŸºäºæ·±åº¦å­¦ä¹ çš„è§†é¢‘è‡ªåŠ¨åˆ‡åˆ†æ–¹æ¡ˆ

## æ¦‚è¿°

æœ¬å·¥å…·ç»“åˆ**é•œå¤´æ£€æµ‹**å’Œ**è¯´è¯äººè¯†åˆ«**æŠ€æœ¯ï¼Œæ™ºèƒ½åˆ¤æ–­è§†é¢‘çš„æœ€ä½³åˆ‡åˆ†ç‚¹ã€‚é€‚ç”¨äºå¹¿å‘Šç´ ææ‹†åˆ†ã€è§†é¢‘å‰ªè¾‘é¢„å¤„ç†ç­‰åœºæ™¯ã€‚

## åŠŸèƒ½ç‰¹æ€§

- ğŸ¬ **é•œå¤´è¾¹ç•Œæ£€æµ‹** - TransNetV2 æ·±åº¦å­¦ä¹ æ¨¡å‹
- ğŸ¤ **è¯­éŸ³è¯†åˆ«** - OpenAI Whisper å¤šè¯­è¨€æ”¯æŒ
- ğŸ‘¥ **è¯´è¯äººè¯†åˆ«** - Resemblyzer åµŒå…¥å‘é‡ + è‡ªåŠ¨èšç±»
- ğŸ§  **æ™ºèƒ½å†³ç­–** - å¤šä¿¡å·èåˆåˆ¤æ–­åˆ‡åˆ†ç‚¹
- âœ‚ï¸ **è§†é¢‘å¯¼å‡º** - FFmpeg æ— æŸåˆ†å‰²

## ç¯å¢ƒè¦æ±‚

- Python 3.9+
- FFmpegï¼ˆéœ€è¦é¢„å…ˆå®‰è£…å¹¶æ·»åŠ åˆ° PATHï¼‰

## å®‰è£…

```bash
# å…‹éš†é¡¹ç›®
git clone https://github.com/yangtuooc/smart-video-segmentation.git
cd smart-video-segmentation

# å®‰è£…ï¼ˆå¼€å‘æ¨¡å¼ï¼‰
pip install -e .
```

## å¿«é€Ÿå¼€å§‹

```bash
# åˆ†æå¹¶åˆ†å‰²è§†é¢‘
sseg input.mp4

# ä»…åˆ†æï¼Œä¸åˆ†å‰²
sseg input.mp4 -n

# æŒ‡å®šè¾“å‡ºç›®å½•
sseg input.mp4 -o ./output

# å¯¼å‡ºåˆ†æç»“æœä¸º JSON
sseg input.mp4 -e result.json -n

# æŸ¥çœ‹å¸®åŠ©
sseg -h
```

## å‘½ä»¤è¡Œå‚æ•°

| å‚æ•° | ç®€å†™ | é»˜è®¤å€¼ | è¯´æ˜ |
|------|------|--------|------|
| `--output` | `-o` | `./segments` | è¾“å‡ºç›®å½• |
| `--model` | `-m` | `base` | Whisper æ¨¡å‹: tiny, base, small, medium, large |
| `--lang` | `-l` | `zh` | è¯­éŸ³è¯­è¨€ä»£ç  |
| `--threshold` | `-t` | `0.5` | é•œå¤´æ£€æµ‹é˜ˆå€¼ (0-1) |
| `--min-seg` | `-s` | `2.0` | æœ€å°ç‰‡æ®µæ—¶é•¿ (ç§’) |
| `--no-split` | `-n` | - | ä»…åˆ†æï¼Œä¸åˆ†å‰²è§†é¢‘ |
| `--export` | `-e` | - | å¯¼å‡ºåˆ†æç»“æœåˆ° JSON |
| `--verbose` | - | - | æ˜¾ç¤ºè¯¦ç»†æ—¥å¿— |

## è¾“å‡ºç¤ºä¾‹

```
æ™ºèƒ½è§†é¢‘åˆ†å‰²å·¥å…·
è¾“å…¥: example.mp4

[1/4] é•œå¤´æ£€æµ‹
[2/4] è¯­éŸ³è¯†åˆ«
[3/4] è¯´è¯äººå˜åŒ–æ£€æµ‹
[4/4] æ™ºèƒ½åˆ†æ

é•œå¤´åˆ‡æ¢: 8 | åˆ‡åˆ†ç‚¹: 2 | è·³è¿‡: 6

åˆ‡åˆ†ç‚¹:
  37.97s - é•œå¤´åˆ‡æ¢ä¸”è¯´è¯äººå˜åŒ–
  101.60s - é•œå¤´åˆ‡æ¢ä¸”è¯´è¯äººå˜åŒ–

ç‰‡æ®µ (3):
  #0: 0.00s ~ 37.97s (37.97s)
  #1: 37.97s ~ 101.60s (63.63s)
  #2: 101.60s ~ 139.60s (38.00s)

å®Œæˆ
```

## é¡¹ç›®ç»“æ„

```
smart-video-segmentation/
â”œâ”€â”€ src/
â”‚   â””â”€â”€ smart_segmenter/
â”‚       â”œâ”€â”€ cli.py                    # CLI å…¥å£
â”‚       â”œâ”€â”€ pipeline.py               # ä¸šåŠ¡æµç¨‹ç¼–æ’
â”‚       â”œâ”€â”€ shot_detector.py          # é•œå¤´æ£€æµ‹ (TransNetV2)
â”‚       â”œâ”€â”€ speech_recognizer.py      # è¯­éŸ³è¯†åˆ« (Whisper)
â”‚       â”œâ”€â”€ speaker_change_detector.py # è¯´è¯äººæ£€æµ‹ (Resemblyzer)
â”‚       â”œâ”€â”€ smart_segmenter.py        # æ™ºèƒ½èåˆå†³ç­–
â”‚       â”œâ”€â”€ video_splitter.py         # è§†é¢‘åˆ†å‰² (FFmpeg)
â”‚       â”œâ”€â”€ models.py                 # æ•°æ®æ¨¡å‹
â”‚       â””â”€â”€ utils.py                  # å·¥å…·å‡½æ•°
â”œâ”€â”€ pyproject.toml
â””â”€â”€ README.md
```
